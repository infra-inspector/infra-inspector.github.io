{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"infra-inspector","text":""},{"location":"#welcome","title":"Welcome","text":"<p>Welcome to the <code>infra-inspector</code> documentation.</p> <p>Please refer to the installation and quick start guides to know how to start.</p>"},{"location":"#key-features","title":"Key features","text":"<p><code>infra-inspector</code> is a CLI utility to inspect various aspects of AWS services:</p> <ul> <li>inventory:   quickly generate an inventory of all the services you're using   in AWS;</li> <li>diagrams:   generate diagrams for your infrastructure resources; the output is a   draw.io file.</li> </ul>"},{"location":"#why-infra-inspector","title":"Why infra-inspector","text":"<p>Navigating through all the services in the AWS console is cumbersome, and generating diagrams manually and keep them updated is a tedious job. <code>infra-inspector</code> automates these processes, so you can use it in CI/CD environment to automatically or periodically generate these useful info.</p>"},{"location":"#future-features","title":"Future features","text":"<ul> <li>visualize the networking config, to help debug connectivity issues between   services (also across different accounts);</li> <li>test the connectivity between two endpoints;</li> <li>support more cloud providers;</li> <li>diagram themes;</li> <li>more installation options (ie. apt/yum packages);</li> <li>more to come.</li> </ul>"},{"location":"#issues","title":"Issues","text":"<p>To report issues, please do it on github.</p>"},{"location":"#diagram-example","title":"Diagram example","text":""},{"location":"commands/","title":"Index","text":""},{"location":"commands/#infra-inspector","title":"infra-inspector","text":"<p>Improve the productivity of developing on AWS cloud</p>"},{"location":"commands/#options","title":"Options","text":"<pre><code>  -h, --help   help for infra-inspector\n</code></pre>"},{"location":"commands/#see-also","title":"SEE ALSO","text":"<ul> <li>infra-inspector diagram  - Generate the diagram from an inventory file</li> <li>infra-inspector inventory  - Generate the AWS inventory, listing all the services used</li> </ul>"},{"location":"commands/#auto-generated-by-spf13cobra-on-16-mar-2025","title":"Auto generated by spf13/cobra on 16-Mar-2025","text":""},{"location":"commands/infra-inspector_diagram/","title":"diagram","text":""},{"location":"commands/infra-inspector_diagram/#infra-inspector-diagram","title":"infra-inspector diagram","text":"<p>Generate the diagram from an inventory file</p>"},{"location":"commands/infra-inspector_diagram/#synopsis","title":"Synopsis","text":"<p>It generates a diagram file (.drawio) that you can open with https://www.drawio.com/, from where you can convert it into different formats (i.e. png, svg)</p> <pre><code>infra-inspector diagram [flags]\n</code></pre>"},{"location":"commands/infra-inspector_diagram/#examples","title":"Examples","text":"<pre><code>diagram --file ./aws-inventory.yml --output ./output.drawio\n</code></pre>"},{"location":"commands/infra-inspector_diagram/#options","title":"Options","text":"<pre><code>  -f, --file stringArray    inventory file (default is ./inventory.yaml); you can provide multiple files by using this argument more than once, all the files will be merged (default [./inventory.yaml])\n  -h, --help                help for diagram\n  -o, --output-dir string   output directory (default is current dir) (default \".\")\n</code></pre>"},{"location":"commands/infra-inspector_diagram/#see-also","title":"SEE ALSO","text":"<ul> <li>infra-inspector    - Improve the productivity of developing on AWS cloud</li> </ul>"},{"location":"commands/infra-inspector_diagram/#auto-generated-by-spf13cobra-on-16-mar-2025","title":"Auto generated by spf13/cobra on 16-Mar-2025","text":""},{"location":"commands/infra-inspector_inventory/","title":"inventory","text":""},{"location":"commands/infra-inspector_inventory/#infra-inspector-inventory","title":"infra-inspector inventory","text":"<p>Generate the AWS inventory, listing all the services used</p>"},{"location":"commands/infra-inspector_inventory/#synopsis","title":"Synopsis","text":"<p>Based on the configuration provided it will scan services in AWS to generate a yaml file with the inventory of all resources in use</p> <pre><code>infra-inspector inventory [flags]\n</code></pre>"},{"location":"commands/infra-inspector_inventory/#options","title":"Options","text":"<pre><code>  -c, --config string   config file (default \"./config.yaml\")\n  -h, --help            help for inventory\n  -o, --output string   output file (default is stdout)\n</code></pre>"},{"location":"commands/infra-inspector_inventory/#see-also","title":"SEE ALSO","text":"<ul> <li>infra-inspector    - Improve the productivity of developing on AWS cloud</li> </ul>"},{"location":"commands/infra-inspector_inventory/#auto-generated-by-spf13cobra-on-16-mar-2025","title":"Auto generated by spf13/cobra on 16-Mar-2025","text":""},{"location":"guides/installation/","title":"Installation","text":"<p>Currently <code>infra-inspector</code> is only available as docker image, so you'll need to install Docker.</p> <p>After that you'll be able to do:</p> <pre><code>docker pull ghcr.io/infra-inspector/infra-inspector:latest\n</code></pre> <p>This will download the <code>infra-inspector</code> image locally, so that you can execute the cli application from a container.</p> <p>You can see all the available versions of the package here.</p>"},{"location":"guides/quick_start/","title":"Quick start","text":""},{"location":"guides/quick_start/#requirements","title":"Requirements","text":"<p>To install <code>infra-inspector</code> you need:</p> <ul> <li>AWS credentials:   this is required to create the inventory file, as <code>infra-inspector</code> will need to   call AWS APIs;</li> <li>Docker: this is required to install   <code>infra-inspector</code>.</li> </ul>"},{"location":"guides/quick_start/#install","title":"Install","text":"<p>Please follow the installation guide.</p>"},{"location":"guides/quick_start/#generate-the-inventory-and-the-diagram","title":"Generate the inventory and the diagram","text":"<p>To generate the inventory:</p> <pre><code>docker run --rm \\\n  -v ~/.aws/credentials:/root/.aws/credentials:ro \\\n  -v `pwd`/inventory-config.yml:/opt/infra-inspector/inventory-config.yml:ro \\\n  -v `pwd`/output:/output \\\n  ghcr.io/infra-inspector/infra-inspector:latest \\\n  inventory -c /opt/infra-inspector/inventory-config.yml -o /output/inventory.yml\n</code></pre> <p>This command assumes an inventory configuration file named <code>inventory-config.yml</code> and a directory <code>output</code> are in the current folder.</p> <p>It also assume that the AWS profile specified in the config exists in <code>~/.aws/credentials</code>. The profile should have the permissions to read all the supported resources, no write permissions are needed.</p>"},{"location":"guides/quick_start/#generate-the-diagram","title":"Generate the diagram","text":"<p>From the inventory we generated above we can then create the diagram with:</p> <pre><code>docker run --rm \\\n  -v `pwd`/output/inventory.yml:/opt/infra-inspector/inventory.yml:ro \\\n  -v `pwd`/output:/output \\\n  ghcr.io/infra-inspector/infra-inspector:latest \\\n  diagram -f /opt/infra-inspector/inventory.yml -o /output/diagram.drawio\n</code></pre> <p>If you need to override some details about the infrastructure (ie. to clarify some resource names, you can edit the inventory YAML file before running the last command).</p> <p>The output can then be opened in Draw.io, which can be used from the CLI as well, in case you need to export the diagram as image.</p>"},{"location":"reference/inventory_yaml/","title":"Inventory data model","text":"<p>This is the structure of the inventory data model, it can generated from the actual deployed resources with the inventory command or manually and used as input for the diagram one to generate the architecture diagram.</p> <pre><code># Accounts map, the key must be the account ID\naccounts:\n  # ID of the account\n  \"000000000000\":\n    # ID of the account\n    id: 000000000000\n    # Account's name\n    name: Production\n    # Regions map\n    regions:\n      # Region ID\n      us-east-1:\n        # Enabled availability zone flags\n        azs:\n          us-east-1a: true  # Enable US-East-1a AZ\n          us-east-1b: false # Disable US-East-1b AZ\n          us-east-1c: false # Disable US-East-1c AZ\n        # List of Internet Gateways\n        internetGateways:\n          -\n            # ID\n            id: ig-0000\n            # Name\n            name: internet-gw\n            # List of VPC the Internet Gateway is attached to\n            vpcs:\n              - vpc-00000 # VPC ID as listed below\n        # Name\n        name: us-east-1\n        # Map of Transit Gateways\n        transitGateways:\n          # ID\n          main-tgw:\n            # ID\n            id: main-tgw\n            # Name\n            name: TGW\n            # Map of TGW attachments\n            attachments:\n              # ID\n              production:\n                # ID\n                id: tgw-attach-prod\n                # Name\n                name: tgw-attachment-production\n                # ID of the account where the attachment is deployed\n                accountId: 000000000000\n                # ID of the TGW this is attached to\n                tgwId: main-tgw\n        # Map of VPCs\n        vpcs:\n          # ID\n          vpc-00000:\n            # ID\n            id: vpc-00000\n            # Name\n            name: production-vpc\n            # CIDR block\n            cidr: 10.10.0.0/16\n            # RDS clusters map\n            dbClusters:\n              # ID\n              product-db-production:\n                # ID\n                id: rds-0000\n                # Name\n                name: product-db-production\n                # DB engine\n                engine: Aurora\n                # DB instances list\n                instances:\n                  -\n                    # ID\n                    id: rds-0000-0\n                    # Name\n                    name: product-db-production-0\n                    # ID of the subnet where the instance is deployed\n                    subnet: subnet-00000000\n                    # Flag to indicate the instance is a primary replica\n                    isReplica: false\n                  -\n                    # ID\n                    id: rds-0000-1\n                    # Name\n                    name: product-db-production-1\n                    # ID of the subnet where the instance is deployed\n                    subnet: subnet-00000000\n                    # Flag to indicate if the instance is a read replica\n                    isReplica: true\n            # Map of Elasticache clusters\n            elasticacheClusters:\n              # ID\n              product-production:\n                # ID\n                id: ec-0000\n                # Name\n                name: product-production\n                # Engine\n                engine: redis\n                # List of subnets where the resource is deployed into\n                subnets:\n                  - subnet-00000000 # subnet ID as listed below\n            # Map of Elastic Load Balancers (ELBs)\n            elbs:\n              # ID\n              public-nlb:\n                # ID\n                id: public-nlb\n                # Name\n                name: public-nlb-production\n                # Flag to indicate whether the LB is public or not\n                isPublic: true\n                # List of subnets where the resource is deployed into\n                subnets:\n                  - subnet-00000000 # subnet ID as listed below\n                # LB type\n                type: network\n            # Flag to indicate whether the VPC is the default one\n            isDefault: true\n            # Map of Managed Streaming for Apache Kafka (MSK) clusters\n            mskClusters:\n              # ID\n              product-production:\n                # ID\n                id: msk-0000\n                # Name\n                name: product-production\n                # List of subnets where the resource is deployed into\n                subnets:\n                  - subnet-00000000 # subnet ID as listed below\n            # Map of OpenSearch clusters\n            openSearchClusters:\n              # ID\n              logging-production:\n                # ID\n                id: os-0000\n                # Name\n                name: logging-production\n                # List of subnets where the resource is deployed into\n                subnets:\n                  - subnet-00000000 # subnet ID as listed below\n            # Map of subnets\n            subnets:\n              # ID\n              subnet-00000000:\n                # ID\n                id: subnet-00000000\n                # Name\n                name: public-production-us-east-1a\n                # CIDR block\n                cidr: 10.10.0.0/24\n                # Flag to indicate that network interfaces attached to instances created in the specified subnet should be assigned a public IPv4 address\n                autoAssignPublicIp: true\n                # Map of EC2 instances\n                instances:\n                  # ID\n                  i-00000000000000003:\n                    # ID\n                    id: i-00000000000000003\n                    # Name\n                    name: \"production-vpn\"\n                    # Public IP\n                    publicIp: 15.184.23.228\n                    # Private IP\n                    privateIp: 10.10.0.9\n                # AZ where the subnet is deployed to\n                az: us-east-1a\n                # List of NAT gateways\n                natGateways:\n                  -\n                    # ID\n                    id: ngw-0000\n                    # Name\n                    name: production-nat-1\n                    # Public IP\n                    publicIp: 15.184.23.229\n                    # Private IP\n                    privateIp: 10.10.0.50\n            # TGW Attachments map\n            tgwAttachments:\n              # ID\n              tgw-attach-prod-0000:\n                # ID\n                id: tgw-attach-prod-0000\n                # Name\n                name: tgw-main\n                # TGW ID\n                tgwId: main-tgw\n                # List of subnets where the resource is deployed into\n                subnets:\n                  - subnet-00000000 # subnet ID as listed below\n</code></pre>"},{"location":"reference/supported_resources/","title":"Supported resources","text":""},{"location":"reference/supported_resources/#aws","title":"AWS","text":"<ul> <li>AWS regions;</li> <li>EC2 instances;</li> <li>Elastic Load Balancers (ELBs);</li> <li>Elasticache;</li> <li>Elasticsearch/OpenSearch clusters;</li> <li>Internet Gateways;</li> <li>Managed Streaming fo Apache Kafka (MSK);</li> <li>NAT gateways;</li> <li>Relational Database Service (RDS) clusters;</li> <li>Subnets;</li> <li>Transit Gateways (TGW);</li> <li>Transit Gateway Attachments;</li> <li>Transit Gateway VPC Attachments;</li> <li>Virtual Private Clouds (VPC);</li> <li>more to come.</li> </ul>"},{"location":"reference/troubleshooting/","title":"Troubleshooting","text":""},{"location":"reference/troubleshooting/#missing-permission-errors","title":"Missing permission errors","text":"<p>If you see an error like the following when running the inventory command:</p> <pre><code>operation error EC2: DescribeAvailabilityZones, https response error StatusCode: 403, RequestID: deae474f-a69f-4f86-aed0-5186e54771ff, api error UnauthorizedOperation: You are not authorized to perform this operation. User: arn:aws:iam::[...]:user/your-user is not authorized to perform: ec2:DescribeAvailabilityZones because no identity-based policy allows the ec2:DescribeAvailabilityZones action\n</code></pre> <p>It means the profile you're using to pull the info from AWS doesn't have the necessary permissions.</p>"},{"location":"reference/configuration/aws-permissions/","title":"Inventory configuration","text":"<p>The following is the minimum required policy to attach to the AWS profile used to generate the inventory:</p> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"VisualEditor1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:DescribeNatGateways\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeTransitGatewayAttachments\",\n        \"ec2:DescribeTransitGateways\",\n        \"ec2:DescribeTransitGatewayVpcAttachments\",\n        \"ec2:DescribeVpcs\",\n        \"elasticache:DescribeCacheClusters\",\n        \"elasticache:DescribeCacheSubnetGroups\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"es:DescribeDomains\",\n        \"es:ListDomainNames\",\n        \"kafka:ListClusters\",\n        \"rds:DescribeDBClusters\",\n        \"rds:DescribeDBInstances\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"reference/configuration/inventory/","title":"Inventory configuration","text":"<p>This is the structure of the configuration to use for the inventory command:</p> <pre><code>awsAccounts:\n  # Add here an entry for each account you want to inspect\n  -\n    # Profile name to access the resources in the account\n    profile: some-profile\n    regions:\n      # List of regions to inspect\n      -\n        # Name of the region to inspect\n        regionName: us-east-1\n        services:\n          # Enable/Disable Elasticcache inspection\n          elasticacheEnabled: false\n          # Enable/Disable ELBs inspection\n          elbEnabled: false\n          # Enable/Disable MSK inspection\n          mskEnabled: false\n          # Enable/Disable ElasticSearch/OpenSearch inspection\n          openSearchEnabled: false\n          # Enable/Disable RDS inspection\n          rdsEnabled: false\n          # Enable/Disable Transit Gateway inspection\n          transitGatewayEnabled: true\noutput:\n  # path of the yaml file\n  path: inventory.yaml\n</code></pre>"}]}